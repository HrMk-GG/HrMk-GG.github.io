<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLãƒŸãƒ‹ã‚¯ãƒ©ãƒ•ãƒˆ</title>
    <style>
        body {
            background-color: #87CEEB; /* ç©ºã®è‰² */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'Press Start 2P', cursive; /* ãƒ‰ãƒƒãƒˆçµµã£ã½ã„ãƒ•ã‚©ãƒ³ãƒˆ */
            color: white;
            text-shadow: 2px 2px 0px black;
        }
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap'); /* ãƒ•ã‚©ãƒ³ãƒˆèª­ã¿è¾¼ã¿ */

        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #FFD700; /* é‡‘è‰² */
            -webkit-text-stroke: 2px #A52A2A; /* èŒ¶è‰²ã®ç¸å–ã‚Š */
            text-shadow: 4px 4px 0px #000;
        }

        #game-area {
            display: grid;
            grid-template-columns: repeat(20, 30px); /* 20x20ã®ã‚°ãƒªãƒƒãƒ‰ */
            grid-template-rows: repeat(20, 30px);
            border: 5px solid #654321; /* æœ¨ã®æ  */
            background-color: #333; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èƒŒæ™¯ */
            image-rendering: pixelated; /* ãƒ‰ãƒƒãƒˆçµµã‚’ãã‚Œã„ã«è¡¨ç¤º */
            box-shadow: 8px 8px 0px #000;
        }

        .block {
            width: 30px;
            height: 30px;
            box-sizing: border-box; /* paddingã¨borderã‚’width/heightã«å«ã‚ã‚‹ */
            border: 1px solid rgba(0,0,0,0.2); /* ãƒ–ãƒ­ãƒƒã‚¯é–“ã®åŒºåˆ‡ã‚Š */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.05s ease-out; /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®åå¿œ */
        }

        /* ãƒ–ãƒ­ãƒƒã‚¯ã®è‰² */
        .air { background-color: #87CEEB; } /* ç©º */
        .grass { background-color: #7CFC00; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30"><rect x="0" y="0" width="30" height="30" fill="%237CFC00"/><path d="M0 25h30v5H0z" fill="%238B4513"/></svg>'); } /* è‰ */
        .dirt { background-color: #8B4513; } /* åœŸ */
        .stone { background-color: #808080; } /* çŸ³ */
        .wood { background-color: #A0522D; } /* æœ¨ */
        .leaves { background-color: #228B22; border-radius: 50%; width: 80%; height: 80%; margin: 10%; box-shadow: inset 0 0 5px rgba(0,0,0,0.3); } /* è‘‰ã£ã± */
        .crafting { background-color: #CD853F; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30"><rect x="0" y="0" width="30" height="30" fill="%23CD853F"/><rect x="5" y="5" width="20" height="20" fill="%23A0522D"/><rect x="10" y="10" width="10" height="10" fill="%23CD853F"/></svg>'); } /* ä½œæ¥­å° */

        #inventory {
            display: flex;
            margin-top: 20px;
            padding: 10px;
            background: rgba(0,0,0,0.5);
            border: 3px solid #654321;
            border-radius: 10px;
            box-shadow: 4px 4px 0px #000;
        }
        .inv-slot {
            width: 40px; height: 40px;
            background-color: rgba(255,255,255,0.1);
            border: 2px solid #aaa;
            margin: 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            position: relative;
            cursor: pointer;
        }
        .inv-slot.selected {
            border-color: #FFD700; /* é¸æŠä¸­ã®æ  */
            box-shadow: 0 0 5px #FFD700;
        }
        .item-count {
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 0.6em;
            color: white;
            text-shadow: 1px 1px 0 black;
        }
        /* ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªå†…ã®ã‚¢ã‚¤ãƒ†ãƒ è¡¨ç¤º */
        .inv-item-grass { background-color: #7CFC00; }
        .inv-item-dirt { background-color: #8B4513; }
        .inv-item-stone { background-color: #808080; }
        .inv-item-wood { background-color: #A0522D; }
        .inv-item-leaves { background-color: #228B22; border-radius: 50%; }

        #controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        .control-btn {
            background-color: #4CAF50; /* ç·‘ */
            color: white;
            padding: 10px 15px;
            border: 2px solid #2E8B57;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8em;
            box-shadow: 2px 2px 0px #000;
        }
        .control-btn:hover {
            background-color: #2E8B57;
        }
        .control-btn:active {
            transform: translateY(1px);
            box-shadow: 1px 1px 0px #000;
        }
    </style>
</head>
<body>
    <h1>ãƒŸãƒ‹ã‚¯ãƒ©ãƒ•ãƒˆ</h1>
    <div id="game-area"></div>
    <div id="inventory"></div>
    <div id="controls">
        <button class="control-btn" onclick="movePlayer(-1, 0)">â† å·¦</button>
        <button class="control-btn" onclick="movePlayer(0, -1)">â†‘ ä¸Š</button>
        <button class="control-btn" onclick="movePlayer(0, 1)">â†“ ä¸‹</button>
        <button class="control-btn" onclick="movePlayer(1, 0)">â†’ å³</button>
    </div>

    <script>
        const GRID_SIZE = 20; // 20x20ãƒã‚¹
        let playerX = 10;
        let playerY = 10;
        let currentItem = 'dirt'; // æŒã£ã¦ã„ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯åœŸï¼‰

        const inventory = {
            dirt: 16,
            grass: 0,
            stone: 0,
            wood: 0,
            leaves: 0,
            crafting: 0 // ä½œæ¥­å°ã‚‚ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã§ç®¡ç†
        };
        const itemClasses = {
            dirt: 'inv-item-dirt',
            grass: 'inv-item-grass',
            stone: 'inv-item-stone',
            wood: 'inv-item-wood',
            leaves: 'inv-item-leaves',
            crafting: 'inv-item-crafting' // å¾Œã§è¿½åŠ 
        };

        const world = []; // ã‚²ãƒ¼ãƒ ä¸–ç•Œã®ãƒãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿
        const blockTypes = ['air', 'grass', 'dirt', 'stone', 'wood', 'leaves', 'crafting'];

        // ãƒ¯ãƒ¼ãƒ«ãƒ‰ç”Ÿæˆ (ç°¡æ˜“çš„ãªåœ°å½¢)
        function generateWorld() {
            for (let y = 0; y < GRID_SIZE; y++) {
                world[y] = [];
                for (let x = 0; x < GRID_SIZE; x++) {
                    if (y < GRID_SIZE / 2 + 2) { // åœ°è¡¨ã‚ˆã‚Šä¸Šã¯ç©º
                        world[y][x] = 'air';
                    } else if (y === GRID_SIZE / 2 + 2) { // åœ°è¡¨
                        world[y][x] = 'grass';
                    } else if (y < GRID_SIZE / 2 + 5) { // ãã®ä¸‹ã¯åœŸ
                        world[y][x] = 'dirt';
                    } else { // ã‚‚ã£ã¨ä¸‹ã¯çŸ³
                        world[y][x] = 'stone';
                    }
                }
            }
            // æœ¨ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é…ç½®
            for (let i = 0; i < 3; i++) {
                const treeX = Math.floor(Math.random() * (GRID_SIZE - 4)) + 2;
                const treeY = GRID_SIZE / 2; // åœ°è¡¨ã«ç”Ÿã‚„ã™
                if (world[treeY][treeX] === 'grass') {
                    world[treeY - 1][treeX] = 'wood';
                    world[treeY - 2][treeX] = 'wood';
                    world[treeY - 3][treeX] = 'leaves';
                    world[treeY - 3][treeX - 1] = 'leaves';
                    world[treeY - 3][treeX + 1] = 'leaves';
                    world[treeY - 4][treeX] = 'leaves';
                }
            }
            // ä½œæ¥­å°ã‚’1ã¤è¨­ç½®
            world[GRID_SIZE / 2 + 2][GRID_SIZE / 2] = 'crafting'; // åœ°è¡¨ã®çœŸã‚“ä¸­ã«ç½®ã
        }

        function renderWorld() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = ''; // ä¸€åº¦ã‚¯ãƒªã‚¢

            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    const block = document.createElement('div');
                    block.classList.add('block', world[y][x]);
                    block.dataset.x = x;
                    block.dataset.y = y;

                    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½ç½®ã«ãƒãƒ¼ã‚¯
                    if (x === playerX && y === playerY) {
                        block.style.backgroundColor = 'rgba(255,255,0,0.5)'; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã„ã‚‹ã‚»ãƒ«ã‚’é»„è‰²ã£ã½ã
                        block.innerText = 'ğŸ‘¤'; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³
                        block.style.fontSize = '1.5em';
                    } else {
                        block.onclick = (e) => {
                            const targetX = parseInt(e.target.dataset.x);
                            const targetY = parseInt(e.target.dataset.y);
                            handleClickBlock(targetX, targetY);
                        };
                    }
                    gameArea.appendChild(block);
                }
            }
            renderInventory();
        }

        function renderInventory() {
            const invElement = document.getElementById('inventory');
            invElement.innerHTML = '';

            for (const item in inventory) {
                const slot = document.createElement('div');
                slot.classList.add('inv-slot');
                if (item === currentItem) {
                    slot.classList.add('selected');
                }
                slot.dataset.item = item;
                slot.onclick = () => selectItem(item);

                const itemDisplay = document.createElement('div');
                itemDisplay.classList.add('inv-item-' + item); // å„ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ«
                itemDisplay.style.width = '70%'; itemDisplay.style.height = '70%';
                slot.appendChild(itemDisplay);

                if (inventory[item] > 0) {
                    const count = document.createElement('span');
                    count.classList.add('item-count');
                    count.innerText = inventory[item];
                    slot.appendChild(count);
                }
                invElement.appendChild(slot);
            }
        }

        function selectItem(item) {
            if (inventory[item] > 0 || item === 'air') { // 'air'ã¯å£Šã™ãƒ¢ãƒ¼ãƒ‰
                currentItem = item;
                renderInventory();
            } else {
                alert('ãã®ã‚¢ã‚¤ãƒ†ãƒ ã¯æŒã£ã¦ã„ã¾ã›ã‚“ï¼');
            }
        }

        function handleClickBlock(targetX, targetY) {
            const distance = Math.abs(playerX - targetX) + Math.abs(playerY - targetY);
            if (distance > 1) { // 1ãƒã‚¹éš£ã®ãƒ–ãƒ­ãƒƒã‚¯ã—ã‹æ“ä½œã§ããªã„
                alert('è¿‘å¯„ã£ã¦ã‹ã‚‰æ“ä½œã—ã¦ã­ï¼');
                return;
            }

            const blockType = world[targetY][targetX];

            if (currentItem === 'air') { // å£Šã™ãƒ¢ãƒ¼ãƒ‰
                if (blockType !== 'air' && blockType !== 'crafting') { // ç©ºã¨ä½œæ¥­å°ã¯å£Šã›ãªã„
                    inventory[blockType]++; // ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã«è¿½åŠ 
                    world[targetY][targetX] = 'air'; // ãƒ–ãƒ­ãƒƒã‚¯ã‚’ç©ºã«ã™ã‚‹
                    renderWorld();
                } else if (blockType === 'crafting') {
                    alert('ä½œæ¥­å°ã¯å£Šã›ãªã„ã‚ˆï¼'); // ä½œæ¥­å°ã¯å£Šã›ãªã„
                }
            } else { // ãƒ–ãƒ­ãƒƒã‚¯ã‚’ç½®ããƒ¢ãƒ¼ãƒ‰
                if (blockType === 'air' && inventory[currentItem] > 0) {
                    inventory[currentItem]--; // ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‹ã‚‰æ¸›ã‚‰ã™
                    world[targetY][targetX] = currentItem; // ãƒ–ãƒ­ãƒƒã‚¯ã‚’ç½®ã
                    renderWorld();
                } else if (inventory[currentItem] === 0) {
                    alert('ãã®ãƒ–ãƒ­ãƒƒã‚¯ãŒè¶³ã‚Šãªã„ã‚ˆï¼');
                } else {
                    alert('ãã“ã«ã¯ç½®ã‘ãªã„ã‚ˆï¼');
                }
            }
        }

        function movePlayer(dx, dy) {
            const newPlayerX = playerX + dx;
            const newPlayerY = playerY + dy;

            // å¢ƒç•Œãƒã‚§ãƒƒã‚¯
            if (newPlayerX >= 0 && newPlayerX < GRID_SIZE &&
                newPlayerY >= 0 && newPlayerY < GRID_SIZE &&
                world[newPlayerY][newPlayerX] !== 'wood' && // æœ¨ã¯é€šã‚Œãªã„
                world[newPlayerY][newPlayerX] !== 'stone' && // çŸ³ã¯é€šã‚Œãªã„
                world[newPlayerY][newPlayerX] !== 'crafting' // ä½œæ¥­å°ã‚‚é€šã‚Œãªã„
                ) {
                playerX = newPlayerX;
                playerY = newPlayerY;
                renderWorld();
            }
        }

        // åˆæœŸåŒ–
        generateWorld();
        renderWorld();

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp') movePlayer(0, -1);
            else if (e.key === 'ArrowDown') movePlayer(0, 1);
            else if (e.key === 'ArrowLeft') movePlayer(-1, 0);
            else if (e.key === 'ArrowRight') movePlayer(1, 0);
            else if (e.key === ' ') selectItem('air'); // ã‚¹ãƒšãƒ¼ã‚¹ã§å£Šã™ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ
            else if (e.key === '1') selectItem('dirt'); // æ•°å­—ã‚­ãƒ¼ã§ã‚¢ã‚¤ãƒ†ãƒ é¸æŠ (ç°¡æ˜“)
            else if (e.key === '2') selectItem('grass');
            else if (e.key === '3') selectItem('wood');
            else if (e.key === '4') selectItem('stone');
            else if (e.key === '5') selectItem('leaves');
            else if (e.key === '6') selectItem('crafting');
        });
    </script>
</body>
</html>
